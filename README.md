Library of bpipe functions for processing minc files
====================================================

minc-bpipe-library provides a set of chainable mincfile processing functions to (pre)process data.

To control which stages are run, edit ``minc-library.bpipe`` and add names using "+" to the "preprocess" segment.
The stages will be run in the order they appear. BeAST should be run as the ``beast`` segment, rather than the
individual stages.'

Stage options have been chosen based on best pratices from publications where applicable but can be changed.

Once you have defined your stages, you can run your pipeline on the SGE cluster with:
```
> module load bpipe #needed to run bpipe
> module load minc-toolkit/1.0.04 #needed for most stages
> module load ANTs #Needed for n4correct
> bpipe run -d /path/to/store/outputs /path/to/minc-library.bpipe /path/to/inputs/*mnc
```

Output filenames from bpipe will be of the form ``<inputname>.stage1.stage2.stage3.ext`` where the last stage
name will be the last run. ``commandlog.txt`` will be generated by bpipe describing all the commands run for
the pipeline. This is a very good file to keep around as as a note of what happened to your data.

Some stages produce both ``mnc`` files and ``xfm`` files, see the ``$output`` variables for what is generated.

Consider the order of your pipeline stages, corrections (noise, n3/n4) should be run before normalization and
data modifying stages like ``cutneck``, ``MNI_register`` and ``beast``.

